<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>簡化版LLC</title>
</head>

<body>
  <h1>簡化版LLC - 直接測試</h1>
  <div id="status">載入中...</div>
  <div id="log"></div>

  <script>
    // 不使用ES模組，改用全域變數方式
    document.getElementById('log').innerHTML = '<div>🚀 開始載入AkingSPICE（全域版本）...</div>';

    // 檢查是否有AkingSPICE全域變數
    if (typeof window.AkingSPICE !== 'undefined') {
      document.getElementById('status').innerHTML = '✅ 找到AkingSPICE全域變數';
      document.getElementById('log').innerHTML += '<div style="color:green">✅ AkingSPICE全域變數可用</div>';
    } else {
      document.getElementById('status').innerHTML = '❌ 沒有找到AkingSPICE全域變數';
      document.getElementById('log').innerHTML += '<div style="color:orange">⚠️ 嘗試載入UMD版本...</div>';

      // 嘗試載入UMD版本
      const script = document.createElement('script');
      script.src = './lib-dist/AkingSPICE.umd.js';
      script.onload = function () {
        document.getElementById('log').innerHTML += '<div style="color:green">✅ UMD版本載入成功</div>';

        if (window.AkingSPICE) {
          document.getElementById('status').innerHTML = '✅ UMD版本可用';
          testComponents();
        } else {
          document.getElementById('status').innerHTML = '❌ UMD版本載入失敗';
        }
      };

      script.onerror = function () {
        document.getElementById('log').innerHTML += '<div style="color:red">❌ UMD版本載入失敗</div>';
        document.getElementById('status').innerHTML = '❌ 所有載入方式都失敗';
      };

      document.head.appendChild(script);
    }

    function testComponents() {
      try {
        document.getElementById('log').innerHTML += '<div>🔧 測試組件創建...</div>';

        const { VoltageSource, Resistor, ExplicitStateSolver } = window.AkingSPICE;

        const v1 = new VoltageSource('V1', [1, 0], 5.0);
        const r1 = new Resistor('R1', [1, 0], 1000);

        document.getElementById('log').innerHTML += '<div style="color:green">✅ 組件創建成功</div>';
        document.getElementById('log').innerHTML += `<div>- 電壓源: ${v1.name}, 值: ${v1.value}V</div>`;
        document.getElementById('log').innerHTML += `<div>- 電阻: ${r1.name}, 值: ${r1.value}Ω</div>`;

        // 創建求解器
        const solver = new ExplicitStateSolver();
        document.getElementById('log').innerHTML += '<div style="color:green">✅ 求解器創建成功</div>';

      } catch (error) {
        document.getElementById('log').innerHTML += `<div style="color:red">❌ 測試失敗: ${error.message}</div>`;
      }
    }
  </script>
</body>

</html>
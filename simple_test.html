<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>ç°¡åŒ–ç‰ˆLLC</title>
</head>

<body>
  <h1>ç°¡åŒ–ç‰ˆLLC - ç›´æ¥æ¸¬è©¦</h1>
  <div id="status">è¼‰å…¥ä¸­...</div>
  <div id="log"></div>

  <script>
    // ä¸ä½¿ç”¨ESæ¨¡çµ„ï¼Œæ”¹ç”¨å…¨åŸŸè®Šæ•¸æ–¹å¼
    document.getElementById('log').innerHTML = '<div>ğŸš€ é–‹å§‹è¼‰å…¥AkingSPICEï¼ˆå…¨åŸŸç‰ˆæœ¬ï¼‰...</div>';

    // æª¢æŸ¥æ˜¯å¦æœ‰AkingSPICEå…¨åŸŸè®Šæ•¸
    if (typeof window.AkingSPICE !== 'undefined') {
      document.getElementById('status').innerHTML = 'âœ… æ‰¾åˆ°AkingSPICEå…¨åŸŸè®Šæ•¸';
      document.getElementById('log').innerHTML += '<div style="color:green">âœ… AkingSPICEå…¨åŸŸè®Šæ•¸å¯ç”¨</div>';
    } else {
      document.getElementById('status').innerHTML = 'âŒ æ²’æœ‰æ‰¾åˆ°AkingSPICEå…¨åŸŸè®Šæ•¸';
      document.getElementById('log').innerHTML += '<div style="color:orange">âš ï¸ å˜—è©¦è¼‰å…¥UMDç‰ˆæœ¬...</div>';

      // å˜—è©¦è¼‰å…¥UMDç‰ˆæœ¬
      const script = document.createElement('script');
      script.src = './lib-dist/AkingSPICE.umd.js';
      script.onload = function () {
        document.getElementById('log').innerHTML += '<div style="color:green">âœ… UMDç‰ˆæœ¬è¼‰å…¥æˆåŠŸ</div>';

        if (window.AkingSPICE) {
          document.getElementById('status').innerHTML = 'âœ… UMDç‰ˆæœ¬å¯ç”¨';
          testComponents();
        } else {
          document.getElementById('status').innerHTML = 'âŒ UMDç‰ˆæœ¬è¼‰å…¥å¤±æ•—';
        }
      };

      script.onerror = function () {
        document.getElementById('log').innerHTML += '<div style="color:red">âŒ UMDç‰ˆæœ¬è¼‰å…¥å¤±æ•—</div>';
        document.getElementById('status').innerHTML = 'âŒ æ‰€æœ‰è¼‰å…¥æ–¹å¼éƒ½å¤±æ•—';
      };

      document.head.appendChild(script);
    }

    function testComponents() {
      try {
        document.getElementById('log').innerHTML += '<div>ğŸ”§ æ¸¬è©¦çµ„ä»¶å‰µå»º...</div>';

        const { VoltageSource, Resistor, ExplicitStateSolver } = window.AkingSPICE;

        const v1 = new VoltageSource('V1', [1, 0], 5.0);
        const r1 = new Resistor('R1', [1, 0], 1000);

        document.getElementById('log').innerHTML += '<div style="color:green">âœ… çµ„ä»¶å‰µå»ºæˆåŠŸ</div>';
        document.getElementById('log').innerHTML += `<div>- é›»å£“æº: ${v1.name}, å€¼: ${v1.value}V</div>`;
        document.getElementById('log').innerHTML += `<div>- é›»é˜»: ${r1.name}, å€¼: ${r1.value}Î©</div>`;

        // å‰µå»ºæ±‚è§£å™¨
        const solver = new ExplicitStateSolver();
        document.getElementById('log').innerHTML += '<div style="color:green">âœ… æ±‚è§£å™¨å‰µå»ºæˆåŠŸ</div>';

      } catch (error) {
        document.getElementById('log').innerHTML += `<div style="color:red">âŒ æ¸¬è©¦å¤±æ•—: ${error.message}</div>`;
      }
    }
  </script>
</body>

</html>
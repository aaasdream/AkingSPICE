<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>模組載入診斷</title>
</head>

<body>
  <h1>AkingSPICE模組載入診斷</h1>
  <div id="log"></div>

  <script type="module">
    console.log('開始載入模組...');

    const log = document.getElementById('log');
    function addLog(msg, type = 'info') {
      const colors = { info: 'black', error: 'red', success: 'green' };
      log.innerHTML += `<div style="color:${colors[type]}; margin:5px 0;">${msg}</div>`;
      console.log(msg);
    }

    addLog('🚀 腳本啟動');

    // 超時處理
    const timeout = setTimeout(() => {
      addLog('❌ 模組載入超時（15秒）', 'error');
    }, 15000);

    try {
      addLog('📦 開始載入模組: ./lib-dist/AkingSPICE.es.js');

      const module = await import('./lib-dist/AkingSPICE.es.js');

      clearTimeout(timeout);
      addLog('✅ 模組載入成功！', 'success');

      // 測試組件
      const { VoltageSource, ExplicitStateSolver } = module;
      addLog(`✅ 組件可用: VoltageSource=${typeof VoltageSource}, Solver=${typeof ExplicitStateSolver}`, 'success');

    } catch (error) {
      clearTimeout(timeout);
      addLog(`❌ 模組載入失敗: ${error.message}`, 'error');
      console.error('詳細錯誤:', error);
    }
  </script>
</body>

</html>
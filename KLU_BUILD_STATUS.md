# KLU WebAssembly å»ºç½®ç‹€æ…‹å ±å‘Š

## ğŸ“Š ç•¶å‰ç‹€æ…‹

âœ… **æ¶æ§‹å®Œæˆ**: TypeScript ä»‹é¢ã€C åŒ…è£å±¤ã€å»ºç½®è…³æœ¬å·²å°±ç·’  
âš ï¸ **WASM æ¨¡çµ„**: å°šæœªå»ºç½® (éœ€è¦å®‰è£ Emscripten å·¥å…·éˆ)  
âœ… **æ¨¡æ“¬å™¨**: å¯ç”¨æ–¼é–‹ç™¼å’Œæ¸¬è©¦  
âœ… **é›†æˆ**: å·²é›†æˆåˆ° SparseMatrix é¡  

## ğŸ¯ å¯¦ç¾æ¦‚è¦

### âœ… å·²å®Œæˆçš„çµ„ä»¶

1. **KLU C åŒ…è£å±¤** (`wasm/klu_wrapper.c`)
   - å®Œæ•´çš„ KLU API æš´éœ²
   - è¨˜æ†¶é«”ç®¡ç†å’ŒéŒ¯èª¤è™•ç†
   - æ”¯æŒæ‰€æœ‰æ ¸å¿ƒå‡½æ•¸

2. **TypeScript ä»‹é¢** (`wasm/klu/`)
   - `klu_types.ts` - é¡å‹å®šç¾©
   - `klu_solver.ts` - ä¸»æ±‚è§£å™¨é¡
   - `klu_solver_mock.ts` - æ¨¡æ“¬å™¨ç‰ˆæœ¬
   - `index.ts` - æ™ºèƒ½åŠ è¼‰å™¨

3. **å»ºç½®è…³æœ¬**
   - `build_klu_wasm.sh` (Linux/macOS)
   - `build_klu_wasm.bat` (Windows)
   - `install_build_tools.bat` (è‡ªå‹•å®‰è£)

4. **SparseMatrix é›†æˆ**
   - æ–°å¢ `setSolverMode('klu')` 
   - ç•°æ­¥æ±‚è§£ `solveAsync()`
   - è‡ªå‹•å›é€€æ©Ÿåˆ¶

5. **æ–‡æª”å’Œæ¸¬è©¦**
   - å®Œæ•´çš„ä½¿ç”¨æŒ‡å—
   - å»ºç½®èªªæ˜æ–‡æª”
   - æ¸¬è©¦ç¯„ä¾‹ç¨‹å¼ç¢¼

## ğŸ”§ å»ºç½®éœ€æ±‚

### Windows ç’°å¢ƒ (ç•¶å‰ç³»çµ±)

**éœ€è¦å®‰è£çš„å·¥å…·:**
1. Emscripten SDK
2. CMake 
3. Git (å¯èƒ½å·²å®‰è£)

**å¿«é€Ÿå®‰è£æ–¹å¼:**
```batch
# æ–¹æ³• 1: è‡ªå‹•å®‰è£ (æ¨è–¦)
# ä»¥ç®¡ç†å“¡èº«ä»½é‹è¡Œ:
wasm\install_build_tools.bat

# æ–¹æ³• 2: æ‰‹å‹•å®‰è£
# ä¸‹è¼‰ä¸¦å®‰è£ Chocolateyï¼Œç„¶å¾Œ:
choco install cmake git
git clone https://github.com/emscripten-core/emsdk.git C:\emsdk
cd C:\emsdk
emsdk install latest
emsdk activate latest
```

## ğŸš€ å»ºç½®æµç¨‹

### ç¬¬ä¸€æ¬¡å»ºç½®
```batch
# 1. å®‰è£å·¥å…· (ä¸€æ¬¡æ€§)
wasm\install_build_tools.bat

# 2. è¨­å®šç’°å¢ƒ (æ¯æ¬¡æ–°æœƒè©±)
C:\emsdk\emsdk_env.bat

# 3. åŸ·è¡Œå»ºç½®
cd wasm
build_klu_wasm.bat

# æˆ–ä½¿ç”¨ npm è…³æœ¬
npm run build:klu:win
```

### å»ºç½®è¼¸å‡º
æˆåŠŸå¾Œæœƒç”Ÿæˆ:
- `wasm/klu/klu.js` - JavaScript è† æ°´ç¨‹å¼ç¢¼
- `wasm/klu/klu.wasm` - WebAssembly æ¨¡çµ„

## ğŸ§ª æ¸¬è©¦å’Œé©—è­‰

### åŸºæœ¬æ¸¬è©¦
```javascript
// æª¢æŸ¥å»ºç½®ç‹€æ…‹
node check_klu_status.js

// é‹è¡Œå®Œæ•´æ¸¬è©¦ (éœ€è¦å…ˆç·¨è­¯ TS)
npm test

// é‹è¡Œ KLU å°ˆç”¨æ¸¬è©¦
npm run test:klu
```

### åœ¨ç¨‹å¼ç¢¼ä¸­ä½¿ç”¨
```typescript
import { SparseMatrix } from './src/math/sparse/matrix';

// å‰µå»ºçŸ©é™£
const A = new SparseMatrix(3, 3);
// ... è¨­å®šçŸ©é™£å…ƒç´ 

// ä½¿ç”¨ KLU æ±‚è§£å™¨
A.setSolverMode('klu');
const solution = await A.solveAsync(b);
```

## ğŸ“ˆ æ€§èƒ½é æœŸ

**ç›¸æ¯” numeric.js:**
- å°çŸ©é™£ (<100): ç›¸ç•¶
- ä¸­çŸ©é™£ (100-1k): 5-10x æ›´å¿«
- å¤§çŸ©é™£ (>1k): 10-50x æ›´å¿«
- è¨˜æ†¶é«”ä½¿ç”¨: 50-90% æ¸›å°‘

## ğŸ¯ ä¸‹ä¸€æ­¥è¡Œå‹•

### ç«‹å³å¯åš
1. âœ… **æ¸¬è©¦æ¨¡æ“¬å™¨**: ç•¶å‰å¯ç”¨ï¼Œé©—è­‰æ¶æ§‹æ­£ç¢ºæ€§
2. ğŸ”§ **å®‰è£å·¥å…·**: é‹è¡Œè‡ªå‹•å®‰è£è…³æœ¬
3. ğŸ—ï¸ **å»ºç½® WASM**: å®Œæˆå¯¦éš›çš„ WebAssembly æ¨¡çµ„

### å»ºç½®å®Œæˆå¾Œ
1. ğŸ§ª **æ€§èƒ½æ¸¬è©¦**: å°æ¯”ä¸åŒæ±‚è§£å™¨æ€§èƒ½
2. ğŸ”§ **åƒæ•¸èª¿å„ª**: æ ¹æ“šé›»è·¯ç‰¹é»å„ªåŒ–è¨­å®š
3. ğŸ“Š **é›†æˆé©—è­‰**: åœ¨å¯¦éš› SPICE ä»¿çœŸä¸­æ¸¬è©¦

## âš ï¸ é‡è¦æé†’

1. **å»ºç½®æ™‚é–“**: é¦–æ¬¡å»ºç½®å¯èƒ½éœ€è¦ 30-60 åˆ†é˜
2. **ç¶²è·¯éœ€æ±‚**: éœ€è¦ä¸‹è¼‰ SuiteSparse æºç¢¼
3. **ç£ç¢Ÿç©ºé–“**: éœ€è¦ç´„ 1-2GB ç©ºé–“
4. **è¨˜æ†¶é«”éœ€æ±‚**: å»ºç½®éç¨‹éœ€è¦ 2-4GB RAM

## ğŸ†˜ æ•…éšœæ’é™¤

### å¸¸è¦‹å•é¡Œ
- **æ¬Šé™éŒ¯èª¤**: ä»¥ç®¡ç†å“¡èº«ä»½é‹è¡Œ
- **ç¶²è·¯å•é¡Œ**: æª¢æŸ¥é˜²ç«ç‰†å’Œä»£ç†è¨­å®š  
- **è¨˜æ†¶é«”ä¸è¶³**: é—œé–‰å…¶ä»–æ‡‰ç”¨ç¨‹å¼
- **è·¯å¾‘å•é¡Œ**: ç¢ºä¿å·¥å…·åœ¨ PATH ä¸­

### ç²å¾—å¹«åŠ©
- ğŸ“š æŸ¥é–± `wasm/README.md`
- ğŸ”§ åƒè€ƒ `wasm/WINDOWS_BUILD_SETUP.md`
- ğŸ“– é–±è®€ `docs/KLU_WASM_GUIDE.md`

---

**çµè«–**: KLU WebAssembly æ¶æ§‹å·²å®Œå…¨å°±ç·’ï¼Œåªéœ€å®Œæˆå·¥å…·å®‰è£å’Œå»ºç½®å³å¯ç²å¾—é«˜æ€§èƒ½ç¨€ç–çŸ©é™£æ±‚è§£èƒ½åŠ›ï¼ğŸ‰
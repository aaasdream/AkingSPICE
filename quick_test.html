<!DOCTYPE html>
<html>
<head>
    <title>快速驗證</title>
</head>
<body>
    <h1>快速驗證</h1>
    <div id="output"></div>

    <script src="lib-dist/AkingSPICE.umd.js"></script>
    <script>
        const output = document.getElementById('output');
        
        function log(msg) {
            console.log(msg);
            output.innerHTML += msg + '<br>';
        }
        
        // 延遲執行，確保腳本完全加載
        setTimeout(() => {
            try {
                log('🔍 開始快速驗證...');
                
                if (!window.AkingSPICE) {
                    log('❌ AkingSPICE未加載');
                    return;
                }
                
                log('✅ AkingSPICE已加載');
                
                const { VoltageSource, Resistor, ExplicitStateSolver } = window.AkingSPICE;
                
                // 最簡單的測試：5V + 10Ω
                const v1 = new VoltageSource('V1', ['n1', 'gnd'], 5);
                const r1 = new Resistor('R1', ['n1', 'gnd'], 10);
                
                log(`元件創建: V1=${v1.value}V, R1=${r1.value}Ω`);
                
                const solver = new ExplicitStateSolver([v1, r1]);
                log('求解器創建完成');
                
                // 執行一步
                solver.step(1e-6);
                const result = solver.getNodeVoltages();
                
                log(`結果: n1=${result.n1?.toFixed(6) || 'undefined'}V`);
                
                const expected = 5.0;
                const actual = result.n1 || 0;
                const error = Math.abs(actual - expected);
                
                if (error < 0.1) {
                    log(`✅ 成功！誤差=${error.toExponential(3)}`);
                } else {
                    log(`❌ 失敗！期望=${expected}V，實際=${actual}V，誤差=${error}`);
                }
                
            } catch (error) {
                log('❌ 錯誤: ' + error.message);
                log('Stack: ' + error.stack);
            }
        }, 1000);
    </script>
</body>
</html>